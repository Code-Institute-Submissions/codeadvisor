{% extends "view/base.html" %}
{% block content %}
<div class='col_7 mt_20'>

  {% if posts|length > 0 %}
  <div class="">
    <span>Sort by: </span>
  </div>
  {% for project in posts %}
  <div class="mt_20 bg_light_blue p_20 rounded">
    <div class="align_center x_space-between">
      <div>
        {% for label in project['stack_labels'] %}
        <span class="tag">{{ label }}</span>
        {% endfor %}
        <h3 class="mt_10">{{ project['name'] }}</h3>
        <em class="text_small color_grey">posted by
          <a class="color_grey" href="/users/{{ project['_user'] }}">{{ project['_user']}}</a> on {{ project['posted_at'].strftime("%d/%m/%Y") }}</em>

      </div>
      {% if project['homepage'] %}
      <a class="icon_button_sm bg_green" target="_blank" href="{{ project['homepage'] }}"><i data-feather="globe"></i></a>
      {% else %}
      <div class="icon_button_sm bg_green">
        <i data-feather="globe" onclick="dialog.open({{ project['_id'] }})"></i>
      </div>

      {% endif %}
    </div>

    <p class="mt_10">{{ project.description or 'No description available for this project.' }}</p>
    <div class="d_flex align_center x_space-between mt_20">
      <div>
        <span class="text_small color_grey">Feedbacks ({{ project['feedbacks'] | length }})</span>
        <span class="text_small color_grey">Views ({{ project['views'] | length}})</span>
      </div>
      <div class="align_center">

        <a href="/posts/{{project['_id']}}" class="button button_sm bg_green">View</a>
        {% if project['_user'] == user_auth['user_name'] %}
        <button onclick="dialog.open({{ project['_id'] + 1  }})" class="icon_button_sm bg_red ml_10"><i data-feather="trash"></i></button>
        {% endif %}
      </div>

    </div>

  </div>


  <div id="dialog_{{ project['_id']  }}" class="dialog">
    <div class="inner">
      <h3>Sorry...</h3>
      <p>The live website for {{ project['name']}} is unvailable!</p>
      <div>
        <a target="_blank" class="mt_20 button button_sm bg_green" href="{{ project['html_url'] }}">Add live website</a>

        <button class="mt_20 ml_10 button button_sm bg_red" onclick="dialog.close({{ project['_id'] }})">Close</button>
      </div>

    </div>

  </div>



  <div id="dialog_{{ project['_id'] + 1 }}" class="dialog">
    <div class="inner">
      <h3>This cannot be undone!</h3>
      <p>Are you sure you want to delete {{ project['name']}}?</p>
      <div>
        <button class="button button_sm bg_green" onclick="dialog.close({{ project['_id'] + 1 }})">Cancel</button>

        <a href="/posts/delete?id={{project['_id']}}&user={{ project['_user'] }}" class="mt_20 ml_10 button button_sm bg_grey">Delete</a>
      </div>

    </div>

  </div>




  {% endfor %}


  {% endif %}


</div>


{% endblock %}
